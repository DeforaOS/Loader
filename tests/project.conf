subdirs=arch/amd64
targets=printself,printself-static,tests.log
as=$(CC)
asflags_force=$(CPPFLAGSF) $(CFLAGSF) -c
asflags=$(CPPFLAGS) $(CFLAGS)
cppflags_force=
cflags_force=-g
cflags=-W -Wall -O2 -fPIE -D_FORTIFY_SOURCE=2 -fstack-protector
ldflags=-pie -Wl,-z,relro -Wl,-z,now
dist=Makefile,tests.sh
mode=amd64-debug

#modes
[mode::amd64-release]
cppflags_force=-DNDEBUG
cflags_force=

[mode::i386-release]
cppflags_force=-DNDEBUG
cflags_force=

#targets
[printself]
type=binary
sources=printself.S

[printself-static]
type=binary
ldflags=-static
sources=printself-static.S

[tests.log]
type=script
script=./tests.sh
depends=$(OBJDIR)printself,$(OBJDIR)printself-static,tests.sh
enabled=0
